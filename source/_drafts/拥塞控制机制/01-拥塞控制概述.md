---
title: 01-拥塞控制概述
date: 2023-11-22 11:30:52
tags:
- TCP
- 计算机网络
---

# 为什么要拥塞控制

###### 情况1
```
  主机 A                              主机 C
        ------> 路由器 ------>
  主机 B                              主机 D

  前提条件: 无限的链路缓存
  链路容量是 R

  当分组到达速率接近链路容量的时候，将会经历巨大的排队延时
```
###### 情况2
```
  主机 A                              主机 C
        ------> 路由器 ------>
  主机 B                              主机 D

  前提条件: 有限的链路缓存
  链路容量是 R

  当分组到达速率超过链路容量的时候，分组将会溢出而丢弃，发送方必须重传由于缓存溢出而丢弃的分组。
```
###### 情况3

```
  主机 A                                                                        主机 C
        ------> 路由器 A ------> 路由器 B ------> 路由器 C ------>
  主机 B                                                                         主机 D

  前提条件: 有限的链路缓存
  链路容量是 R

  当分组到达C被丢弃的时候，那么上游 A～C之间的传输容量被浪费了。
```
# 拥挤塞控制的目的

从上面分析拥塞的原因，发现如果网络发生拥塞，将会导致我们会重传不需要重传的数据，导致恶性循环，或者由于丢失导致上游路由器带宽的浪费，所以拥挤塞控制的目的事：**最大限度的利用带宽，传输有效数据**

# 拥塞控制算法需要解决以下三个问题
- `TCP` 如何检测网络中是否拥塞 （拥塞窗口机制 `cwnd`）
- `TCP` 如何限制数据的发送速率（轻微拥塞，拥塞）
- `TCP` 采用什么算法来调整速率（什么时候调整，调整多少，轻微拥塞如何调整、拥塞如何调整)

## 轻微拥塞
收到三个冗余 ACK
## 拥塞

超时

## 拥晒控制的检测方法

- 端到端的拥塞控制
  在这种控制方法中由发送端自己来判断是否拥晒，然后调整发送速率
  对于 TCP 发送方来说，没有一个精确的方法知晓路由器的中间状态，没有一个明确的信号告知拥塞已经发生，典型的 TCP判断是否拥塞，通常看是否有丢包的情况发生

  为什么会丢包
  - 中间路由器缓存溢出导致丢包
  - 段所在的分组，分组所在的帧出现bit反转，出错导致校验没通过而丢包

  **注意无线网之前出错导致的丢包远远小于溢出导致的丢白，可以忽略不计**

## 拥塞发生后何时减速以及怎么减速（包括如何恢复传输速率)

- 减缓 TCP 发送
  - 发送端引入窗口控制变量，确保发送窗口大小不超过接收端接收能力和网络传输能力，TCP 发送速率等于接受速率和传输速率的最小值
  ```
  w = min(cwnd, awnd)
  ```
  cwmd: 拥塞控制窗口
  w： 发送端实际可用窗口
  awnd：通知窗口（接收方反馈的）